---
import { env } from 'cloudflare:workers';
import { resolvePublication } from '../lib/resolve-publication';
import { getPublicationBranding } from '../dl/publication';
import NotFoundPage from '../components/NotFoundPage.astro';

let branding = null;

try {
  const publication = await resolvePublication(Astro.request, env.DAL, env.DEV_PUBLICATION_SLUG);
  if (publication) {
    branding = getPublicationBranding(publication);
  }
} catch {
  // If publication resolution fails, render a generic 404
}
---

<NotFoundPage
  templateId={branding?.templateId ?? 'starter'}
  {branding}
/>
