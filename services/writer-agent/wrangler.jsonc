{
	"$schema": "node_modules/wrangler/config-schema.json",
	"name": "hotmetal-writer-agent",
	"main": "src/index.ts",
	"compatibility_date": "2026-02-05",
	"compatibility_flags": ["nodejs_compat"],
	"observability": {
		"enabled": true,
	},

	"dev": {
		"port": 8789
	},

	// Durable Objects — one WriterAgent instance per writing session
	"durable_objects": {
		"bindings": [
			{
				"name": "WRITER_AGENT",
				"class_name": "WriterAgent",
			},
		],
	},

	// SQLite migrations for agent-local state (drafts, research_notes)
	"migrations": [
		{
			"tag": "v1",
			"new_sqlite_classes": ["WriterAgent"],
		},
	],

	// D1 Database for cross-session metadata (listing, search)
	"d1_databases": [
		{
			"binding": "WRITER_DB",
			"database_name": "hotmetal-writer-db",
			"database_id": "5fc8f7a4-e05f-47ce-b638-f78a90057f43",
			"migrations_dir": "./migrations",
		},
	],

	// Environment variables (non-secret)
	"vars": {
		"CMS_URL": "http://localhost:8787",
		"ALEXANDER_API_URL": "https://alexanderai.farfarawaylabs.com",
		"CONTENT_SCOUT_URL": "http://localhost:8790",
	},

	// Secrets (set via `wrangler secret put`):
	// ANTHROPIC_API_KEY, CMS_API_KEY, WRITER_API_KEY, ALEXANDER_API_KEY
	// CONTENT_SCOUT_API_KEY — must match API_KEY on the content-scout worker
}
